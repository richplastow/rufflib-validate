!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):((t="undefined"!=typeof globalThis?globalThis:t||self).rufflib=t.rufflib||{},t.rufflib.expect=t.rufflib.expect||{},t.rufflib.expect.main=e())}(this,(function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var c=e[n];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(t,c.key,c)}}
/**
   * rufflib-expect 2.0.0
   * A RuffLIB library for unit testing rough and sketchy JavaScript apps.
   * https://richplastow.com/rufflib-expect
   * @license MIT
   */
var c=/^[.#]?[a-z][-_0-9a-z]*$/i;var o="expect.render(): ",i="[1m",a="[0m",r="[2m",s="[0m",l="[32mâˆš ",u="[0m",d="[31mX ",f="[0m",p="<h2>",h="</h2>",y="<s>",T="</s>",g="<i>âˆš ",x="</i>",m="<u>X ",b="</u>";function k(t,e,n,c,p,h,y){var T=function(t,e,n){return"-".repeat(79)+"\n"+"".concat(i).concat(n).concat(a,"\n")+"=".repeat(n.length)+"\n"+(t?"".concat(d,"Failed").concat(f," ").concat(t," of ").concat(t+e):"".concat(l,"Passed").concat(u," ").concat(e," test").concat(1===e?"":"s"))+"\n"+"-".repeat(79)+"\n"}(e,n,p);return T+t.map((function(t){if((t.sectionTitle?t.sectionTitle:c[t.sectionIndex].sectionTitle).toLowerCase().includes(h))switch(t.kind){case"Error":return"".concat(d,"Failed").concat(f," ").concat(t.testTitle,":\n")+"  ".concat(r,"actually is an error:").concat(s,"\n")+"  ".concat(t.actually,"\n");case"Failed":return"".concat(d,"Failed").concat(f," ").concat(t.testTitle,":\n")+"  ".concat(r,"expected:").concat(s," ").concat(t.expected,"\n")+"  ".concat(r,"actually:").concat(s," ").concat(t.actually,"\n");case"Passed":return y?"".concat(l,"Passed").concat(u," ").concat(t.testTitle,"\n"):"";case"SectionTitle":return y||c[t.sectionIndex].failTally?"\n".concat(i).concat(t.sectionTitle,":").concat(a,"\n")+"-".repeat(t.sectionTitle.length+1)+"\n":"";default:throw Error("".concat(o,"unexpected item.kind"))}})).join("")+(y?"\n\n"+T:"")}function S(t,e,n,c,i,a,r){var s=function(t,e,n){return"<hr>"+"".concat(p).concat(n).concat(h,"\n")+(t?"".concat(m,"Failed").concat(b," ").concat(t," of ").concat(t+e):"".concat(g,"Passed").concat(x," ").concat(e," test").concat(1===e?"":"s"))+"\n<hr>\n"}(e,n,i);return s+t.map((function(t){if((t.sectionTitle?t.sectionTitle:c[t.sectionIndex].sectionTitle).toLowerCase().includes(a))switch(t.kind){case"Error":return"".concat(m,"Failed").concat(b," ").concat(t.testTitle,":\n")+"  ".concat(y,"actually is an error:").concat(T,"\n")+"  ".concat(t.actually,"\n");case"Failed":return"".concat(m,"Failed").concat(b," ").concat(t.testTitle,":\n")+"  ".concat(y,"expected:").concat(T," ").concat(t.expected,"\n")+"  ".concat(y,"actually:").concat(T," ").concat(t.actually,"\n");case"Passed":return r?"".concat(g,"Passed").concat(x," ").concat(t.testTitle,"\n"):"";case"SectionTitle":return r||c[t.sectionIndex].failTally?"\n".concat("<b>").concat(t.sectionTitle,":").concat("</b>","\n"):"";default:throw Error("".concat(o,"unexpected item.kind"))}})).join("")+(r?"\n\n"+s:"")}function v(t,e,n,c,i,a,r){return"{\n"+'  "fail_tally": '.concat(e,",\n")+'  "pass_tally": '.concat(n,",\n")+'  "status": "'.concat(e?"fail":"pass",'",\n')+'  "suite_title": "'.concat(i,'",\n')+'  "log": [\n'+t.map((function(t){if((t.sectionTitle?t.sectionTitle:c[t.sectionIndex].sectionTitle).toLowerCase().includes(a))switch(t.kind){case"Error":return'    { "kind": "Error", "test_title": "'.concat(t.testTitle,'",\n')+'      "error": '.concat(JSON.stringify(t.actually)," },\n");case"Failed":return'    { "kind": "Failed", "test_title": "'.concat(t.testTitle,'",\n')+'      "expected": '.concat(JSON.stringify(t.expected),",\n")+'      "actually": '.concat(JSON.stringify(t.actually)," },\n");case"Passed":return r?'    { "kind": "Passed", "test_title": "'.concat(t.testTitle,'" },\n'):"";case"SectionTitle":return r||c[t.sectionIndex].failTally?'    { "kind": "SectionTitle", "section_title": "'.concat(t.sectionTitle,'" },\n'):"";default:throw Error("".concat(o,"unexpected item.kind"))}})).join("").slice(0,-2)+"\n  ]\n}"}function w(t,e,n,c,i,a,r){var s=function(t,e,n){return"-".repeat(79)+"\n"+"".concat(n,"\n")+"=".repeat(n.length)+"\n"+(t?"Failed ".concat(t," of ").concat(t+e):"Passed ".concat(e," test").concat(1===e?"":"s"))+"\n"+"-".repeat(79)+"\n"}(e,n,i);return s+t.map((function(t){if((t.sectionTitle?t.sectionTitle:c[t.sectionIndex].sectionTitle).toLowerCase().includes(a))switch(t.kind){case"Error":return"Failed ".concat(t.testTitle,":\n")+"  actually is an error:\n"+"  ".concat(t.actually,"\n");case"Failed":return"Failed ".concat(t.testTitle,":\n")+"  expected: ".concat(t.expected,"\n")+"  actually: ".concat(t.actually,"\n");case"Passed":return r?"Passed ".concat(t.testTitle,"\n"):"";case"SectionTitle":return r||c[t.sectionIndex].failTally?"\n".concat(t.sectionTitle,":\n")+"-".repeat(t.sectionTitle.length+1)+"\n":"";default:throw Error("".concat(o,"unexpected item.kind"))}})).join("")+(r?"\n\n"+s:"")}function E(t){return t}function I(t,e){var n=this,c=this.log,o=this.sections,i=function(t){return o.push({failTally:0,sectionTitle:t})-1},a=function(){return o[o.length-1].failTally++,n.failTally++,n.status="fail",o.length-1},r=function(){return n.passTally++,o.length-1};return{section:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Untitled Section";c.push({kind:"SectionTitle",sectionIndex:i(t),sectionTitle:t})},is:function(n){return o.length||this.section(),e===n?(c.push({kind:"Passed",sectionIndex:r(),testTitle:t}),!0):(c.push({actually:e,expected:n,kind:"Failed",sectionIndex:a(),testTitle:t}),!1)},hasError:function(n){return o.length||this.section(),e&&(null==e?void 0:e.error)===n?(c.push({kind:"Passed",sectionIndex:r(),testTitle:t}),!0):(c.push({actually:e?null==e?void 0:e.error:e,expected:n,kind:"Failed",sectionIndex:a(),testTitle:t}),!1)},has:function(n){if(o.length||this.section(),e.error)return c.push({actually:e.error,expected:JSON.stringify(n),kind:"Error",sectionIndex:a(),testTitle:t}),!1;for(var i in n){var s=JSON.stringify(e[i]),l=JSON.stringify(n[i]);if(s!==l)return c.push({actually:s,expected:l,kind:"Failed",sectionIndex:a(),testTitle:"".concat(t,".").concat(i)}),!1}return c.push({kind:"Passed",sectionIndex:r(),testTitle:t}),!0},stringifiesTo:function(n){o.length||this.section();var i=JSON.stringify(e),s=JSON.stringify(n);return i===s?(c.push({kind:"Passed",sectionIndex:r(),testTitle:t}),!0):(c.push({actually:i,expected:s,kind:"Failed",sectionIndex:a(),testTitle:t}),!1)},passes:function(n){return o.length||this.section(),n&&null!=n&&n.test(e)?(c.push({kind:"Passed",sectionIndex:r(),testTitle:t}),!0):(c.push({actually:e,expected:n,kind:"Failed",sectionIndex:a(),testTitle:t}),!1)}}}var P=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Untitled Test Suite";e(this,t),this.that=I.bind(this),this.suiteTitle=n,this.reset()}var c,o,i;return c=t,(o=[{key:"reset",value:function(){this.log=[],this.sections=[],this.failTally=0,this.passTally=0,this.status="pass"}}])&&n(c.prototype,o),i&&n(c,i),Object.defineProperty(c,"prototype",{writable:!1}),t}();return P.VERSION="2.0.0",P.generateCss=function(e,n){var o=e,i=n;if(!o)throw Error("Expect.generateCss(): the mandatory containerSelector argument is falsey");if("string"!=typeof o)throw Error("Expect.generateCss(): containerSelector is type '".concat(t(o),"' not 'string'"));if(!c.test(o))throw Error("Expect.generateCss(): containerSelector fails ".concat(c));if(!i)throw Error("Expect.generateCss(): the mandatory innerSelector argument is falsey");if("string"!=typeof i)throw Error("Expect.generateCss(): innerSelector is type '".concat(t(i),"' not 'string'"));if(!c.test(i))throw Error("Expect.generateCss(): innerSelector fails ".concat(c));var a=["/* Expect.generateCss('".concat(o,"', '").concat(i,"') */")];return a.push("".concat(o,".fail{background:#642c2c;color:#fce}"),"".concat(o,".pass{background:#2c642c;color:#cfe}")),a.push("".concat(i,"{padding:4px 8px;border-radius:4px;line-height:1.8}"),"".concat(i,"{font-family:Menlo,Consolas,Monaco,Lucida Console,Liberation Mono,"),"DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace,sans-serif}","".concat(i,"{text-align:left;white-space:pre}"),"".concat(i,"{background:#222;color:#eee}"),"".concat(o,".fail ").concat(i,"{background:#411;color:#fce}"),"".concat(o,".pass ").concat(i,"{background:#141;color:#cfe}"),"".concat(o,".fail hr{border-color:#642c2c}"),"".concat(o,".pass hr{border-color:#2c642c}")),a.push("".concat(i," h2{margin:0}"),"".concat(i," b{color:#eee}"),"".concat(i," i{font-style:normal}"),"".concat(o,".pass i{color:#7fff7f}"),"".concat(i," u{padding:2px 8px;color:#fff;background:#900;text-decoration:none}"),"".concat(i," s{color:#9c8293;text-decoration:none}")),a.join("\n")},P.prototype.render=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Plain",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=this.log,i=this.failTally,a=this.passTally,r=this.sections,s=this.suiteTitle,l={Ansi:k,Html:S,Json:v,Plain:w,Raw:E}[t];if(!l)throw Error("".concat(o,"unexpected format, try 'Ansi|Html|Json|Plain|Raw'"));return l(c,i,a,r,s,e.toLowerCase(),n)},P.prototype.section=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Untitled Section";this.log.push({kind:"SectionTitle",sectionIndex:this.sections.push({failTally:0,sectionTitle:t})-1,sectionTitle:t})},P}));
